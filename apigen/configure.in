dnl
dnl vim:ts=8:sw=8:sts=0
dnl
dnl $Id$
dnl

dnl Process this file with autoconf to produce a configure script.
AC_INIT(configure.in)
AM_INIT_AUTOMAKE(apigen, 0.5)

dnl Our own version of libdir whose value is set dynamically
AC_SUBST(INSTLIBDIR)
INSTLIBDIR="$libdir"

AC_REQUIRE([AC_PROG_CC])

dnl Which compiler to use?
AC_PROG_CC

dnl What commands are needed to set the variable MAKE in Makefiles?
AC_SET_MAKE

dnl {{{ Ranlib stuff

AC_PROG_RANLIB
AR=ar
AC_SUBST(AR)

dnl }}}

dnl {{{ Handle --with-asc-support

AC_ARG_WITH(asc-support,
[  --with-asc-support=DIR  asc-support is in DIR],
ASCSUPPORT=${withval},
ASCSUPPORT=${prefix})

ASCINC="${ASCSUPPORT}/include"
ASCLIB="${ASCSUPPORT}/lib"
AC_SUBST(ASCINC)
AC_SUBST(ASCLIB)

dnl }}}
dnl {{{ Handle --with-asfix

AC_ARG_WITH(asfix,
[  --with-asfix=DIR        asfix is in DIR],
ASFIX=${withval},
ASFIX=${prefix})

ASFIXINC="${ASFIX}/include"
ASFIXLIB="${ASFIX}/lib"
AC_SUBST(ASFIXINC)
AC_SUBST(ASFIXLIB)

dnl }}}
dnl {{{ Handle --with-asource

AC_PATH_PROG(ASOURCE, asource, no)
if test "${ASOURCE}" = "no"; then
	ASOURCE='${prefix}'
else
	ASOURCE=`dirname \`dirname ${ASOURCE}\``
fi

AC_ARG_WITH(asource,
[  --with-asource=DIR      asource distribution is in DIR],
ASOURCE=${withval},)

AC_ARG_WITH(asource-bin,
[  --with-asource-bin=DIR  asource executables are in DIR],
ASOURCEBIN=${withval},
ASOURCEBIN="${ASOURCE}/bin")

AC_SUBST(ASOURCEBIN)

dnl }}}
dnl {{{ Handle --with-aterm

AC_ARG_WITH(aterm,
[  --with-aterm=DIR        ATerm-library is in DIR],
ATERM=${withval},
ATERM=${prefix})
ATERMINC="${ATERM}/include"
ATERMLIB="${ATERM}/lib"
AC_SUBST(ATERMINC)
AC_SUBST(ATERMLIB)

dnl }}}
dnl {{{ Handle --with-pgen

AC_PATH_PROG(PGEN, parsetablegen, no)
if test "${PGEN}" = "no"; then
	PGEN='${prefix}'
else
	PGEN=`dirname \`dirname ${PGEN}\``
fi

AC_ARG_WITH(pgen,
[  --with-pgen=DIR         pgen distribution is in DIR],
PGEN=${withval},)

AC_ARG_WITH(pgen-bin,
[  --with-pgen-bin=DIR     pgen executables are in DIR],
PGENBIN=${withval},
PGENBIN="${PGEN}/bin")

AC_SUBST(PGENBIN)

dnl }}}
dnl {{{ Handle --with-sglr

AC_PATH_PROG(SGLR, sglr, no)
if test "${SGLR}" = "no"; then
	SGLR='${prefix}'
else
	SGLR=`dirname \`dirname ${SGLR}\``
fi

AC_ARG_WITH(sglr,
[  --with-sglr=DIR         sglr distribution is in DIR],
SGLR=${withval},)

AC_ARG_WITH(sglr-bin,
[  --with-sglr-bin=DIR     sglr executables are in DIR],
SGLRBIN=${withval},
SGLRBIN="${SGLR}/bin")

AC_SUBST(SGLRBIN)

dnl }}}

dnl {{{ Output files

dnl Which files need updating?
AC_OUTPUT(
Makefile
spec/Makefile
utils/Makefile
utils/gen-c-api
utils/sdf2-to-adt
test/Makefile
spec/gen-c-api/Makefile
spec/sdf2-to-adt/Makefile
,
chmod +x utils/gen-c-api utils/sdf2-to-adt
)

dnl }}}
